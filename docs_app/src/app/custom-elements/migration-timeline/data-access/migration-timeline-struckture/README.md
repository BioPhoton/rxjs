# Data structure for the Migration-Timeline
The structure aims to be autogenerated from the code in the future.

It links the message in the sourcecode following the pattern:
`<HumanReadableShortMessage> - see <LinkToMigrationTimeLineItemInDocs>`

with the related migration time-line.

It's an array of `MigrationReleaseItem` items.

## MigrationRelease

The migration time-line consists out of a list of `MigrationRelease` items.

A `MigrationRelease` has following structure:
```typescript
export interface MigrationRelease extends MigrationReleaseUIDFields {
  date: string;
  deprecations: Deprecation[];
  breakingChanges: BreakingChange[];
}
```

**date**  
description: Any valid UTC string.
- When did the releases happen?
- When will the release most probably happen?
type: string
Examples:
- YYYY
- YYYY-MM
- YYYY-MM-DD

**deprecations**  
type: Deprecation[]
description: A list of Deprecation items

**breakingChanges**  
type: BreakingChange[]
description: A list of BreakingChange items

### MigrationReleaseUIDFields
Every MigrationRelease has a unique id which is generated out of meta information about the related release.

The interface specifying the meta information for the `MigrationReleaseUID` looks like this:
```typescript
export interface MigrationReleaseUIDFields {
  version: string;
}
```

**version**  
description: Any valid semver string from only major [n] to very specific [n.n.n.s-n]. What version is effected?
type: string
Examples:
 - 1
 - 1.1
 - 1.1.1
 - 1.1.1-alpha.1

--- 

The Pattern to generate the `MigrationReleaseUID` for a MigrationRelease is defined as following:  

**UID Pattern**  
`<version>`  
Examples:
 - 1
 - 1.1
 - 1.1.1
 - 1.1.1-alpha.1
     
### MigrationItems

Every Migration Release consists out of time-line consists out of `MigrationItems`.

The items `deprecations` and `breakingChanges` are considered as `MigrationItems`.

Every `MigrationItem` has a unique id `MigrationItemSubjectUID` which is generated out of the `MigrationItemSubjectUID` and the `MigrationReleaseUID`.

#### MigrationItemSubjectUIDFields
The interface specifying the meta information for the `MigrationItemSubjectUIDFields` a looks like this:
```typescript
export interface MigrationItemSubjectUIDFields {
  itemType: TimeLineTypes;
  subject: string;
  subjectAction: string;
  subjectApiSymbol: ApiSymbols;
}
```
**itemType**  
description: Type of MigrationItem
type: TimeLineTypes

**subject**  
description: Subject of migration. What piece is effected?
type: string
Examples:
- TestScheduler
- of
- NEVER
- switchMap

**subjectApiSymbol**  
description: Type of ApiSymbols
type: ApiSymbols

##### ApiSymbols
`ApiSymbols` represents a list of possible effected code types as follow:

```typescript
export enum ApiSymbols {
  all = 'all',
  argument = 'argument',
  class = 'class',
  interface = 'interface',
  function = 'function',
  enum = 'enum',
  const = 'enum',
  let = 'let',
  var = 'var',
  typeAlias = 'type-alias',
}
```

**subjectAction**  
description: Action on subject.
dash "-" separated string
- What happened to the subject?
- What attribute of the piece is effected?
type: string
Examples:
- deprecated
- argument-resultSelector
- property-frameTimeFactor
- property-access-specifier-(private|public|readonly)-changed
- removed
- moved
- to-private
- multiple-arguments-to-one
- argument-resultSelector-removed
- property-frameTimeFactor-moved
- property-hotObservables-to-private

--- 

The Pattern to generate the `MigrationItemSubjectUID` for a `MigrationItem` is defined as following:
**UID Pattern**  
`<itemType>-<subjectApiSymbol>-<subject>-<subjectAction>` 

---

#### MigrationItemUIDFields
The interface specifying the meta information for the `MigrationItemUID` a looks like this:
```typescript
export interface MigrationItemUIDFields extends MigrationReleaseUIDFields, MigrationItemSubjectUIDFields {
}
```
description: Summarizes all information needed to generate the UID for a `MigrationItem`

The Pattern to generate the `MigrationItemUID` for a `MigrationItem` is defined as following:
**SubjectUID Pattern**  
`<MigrationReleaseUID>_<MigrationItemSubjectUID>` 

#### Deprecation
**itemType** 
description: Override of `MigrationItemUIDFields` property `itemType` to MigrationTimeTypeDeprecation
type: TimeLineTypeDeprecation
Example:
- deprecation

**sourceLink** 
description: Link to line of code in GitHub in version it got introduced.
The link should target the tag where the deprecation got introduced and point to the exact line of code.
type: string
Example:
https://github.com/ReactiveX/rxjs/blob/6.0.0-tactical-rc.1/src/internal/Scheduler.ts#L20

**breakingVersion** 
description: semver string of breaking version
type: semVerString

**breakingSubjectAction** 
description: subjectAction of related `BreakingChange` item
type: string
Example:

**deprecationMsgCode** 
description: The message from the code placed next to `@deprecated` section
type: string

**reason** 
description: Reason of the deprecation
type: string

**implication** 
description: This section is an explanation that accompanies the 'before deprecation' and 'after deprecation' snippets.
It explains the different between the two versions to the user
in a detailed way to help the user to spot the differences in code.
type: string

**exampleBefore** 
description: Code example showing the situation before the deprecation
type: string
Pattern:
  <imports>
  <code>
Example:
  import {empty} from 'rxjs';
  empty();
  
**exampleAfter** 
description: Code example showing the situation before the deprecation
type: string
Pattern:
  <imports>
  <code>
Example:
  import {EMPTY} from 'rxjs';
  EMPTY;

#### BreakingChange 

**itemType** 
description: Override of `MigrationItemUIDFields` property `itemType` to MigrationTimeTypeBreakingChange
type: MigrationTimeTypeBreakingChange
Example:
- breakingChange

**deprecationVersion** 
description: semver string of release where deprecation got introduced
type: semVerString

**deprecationSubjectAction** 
description: subjectAction of related `Deprecation` item
type: string

**breakingChangeMsg** 
description: A message that explains what exactly is breaking
type: string
Example: Class `TestScheduler` changed property `coldObservables` to private

---

#Example date:

```typescript
const migrationReleaseItems: MigrationReleaseItem[] = [
 {
    version: '7.0.0-test.99',
    date: '2019-11-18',
    deprecations: [
      {
        subject: 'TestScheduler',
        subjectApiSymbol: ApiSymbols.class,
        subjectAction: 'property-coldObservables',
        sourceLink: 'https://github.com/ReactiveX/rxjs/blob/7.0.0-alpha.0/src/internal/testing/TestScheduler.ts#L44',
        itemType: 'deprecation',
        breakingVersion: '7.0.0-test.99',
        breakingSubjectAction: 'property-coldObservables-to-private',
        deprecationMsgCode: 'Class `TestScheduler` deprecate the public property `coldObservables`',
        reason: '@TODO `TestScheduler` deprecates public `coldObservables` property and makes it protected as it is and internal.',
        implication: '@!TODO',
        exampleBefore: '@TODO',
        exampleAfter: '@TODO'
      }
    ],
    breakingChanges: [
      {
        subject: 'TestScheduler',
        subjectApiSymbol: ApiSymbols.class,
        subjectAction: 'property-coldObservables-to-private',
        itemType: 'breakingChange',
        deprecationVersion: '7.0.0-test.99',
        deprecationSubjectAction: 'property-coldObservables',
        breakingChangeMsg: 'Class `TestScheduler` changed property `coldObservables` to private'
      }
    ]
  }
]
```